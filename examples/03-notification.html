<html>
    <head>
        <title>JavaScript Does THAT!? Examples</title>
        <link href="base/main.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript" src="base/demo.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>

    <body>
        
        <header>
            <h1>Notifications API</h1>
            <p><a href="../index.html">Return to Main Menu</a></p>
        </header>

        <div class="content">

            <div class="card">
                <h2>What is the <span class="mono">Notifications API</span>?</h2>
                <p>Send browser- and device-native notifications from a website or webapp.</p>

                <h2>When and why should you use the <span class="mono">Notifications API</span>?</h2>
                <p>Notifications inform users of updates from your website - whether informational or transactional. Note that notifications require explicit opt-in from the user; a user is more likely to grant permission when they understand the value of why you want to send notifications.</p>
            </div>

            <div class="card">
                <h2>Demo: notification permission</h2>

                <button type="button" onclick="requestPermission();">Request permission</button>
                <p>Prompts the user to grant/deny permission for notifications.</p>

                <h2>Demo: send a native notification</h2>

                <button type="button" onclick="sendNotification();">Send notification</button>
                <p>Send a notification to the user's device. This requires a secure (HTTPS) connection (won't work locally from a file).</p>

                <div id="Console" class="output code"></div>

            </div>

        </div>
        
        <script type="text/javascript">

            let requestPermission = async () => {

                Demo.clear();
                Demo.log("Requested notification permission...");

                let result = await Notification.requestPermission();
                Demo.log(`Permission: ${result}`);

            };

            let sendNotification = async () => {

                // NOTE: this will only work in a secure (HTTPS) context

                Demo.clear();

                // Get permission to send notifications
                let result = await Notification.requestPermission();

                if (result === "granted") {

                    // Set up notification options
                    let options = {

                        body: "This is your reminder to drink lots of water. Stay hydrated!",
                        img: "/content/notification-image.png",
                        icon: "/content/notification-icon.png"

                    };

                    // Create a notification
                    let notification = new Notification("Time to drink!", options);

                    Demo.log("Notification sent!");

                } else {

                    Demo.log("User has denied notification permissions.");

                }

            };

        </script>

    </body>
</html>